Description: This patch fixes CVE-2017-14120
 CVE-2017-14120 describes a security issue about directory traversal
 vulnerability.
Author: Chris Lamb <lamby@debian.org>
Bug-Debian: https://bugs.debian.org/874059
Last-Update: 2017-09-07

Index: unrar-free-0.0.1+cvs20140707/src/unrar.c
===================================================================
--- unrar-free-0.0.1+cvs20140707.orig/src/unrar.c
+++ unrar-free-0.0.1+cvs20140707/src/unrar.c
@@ -362,6 +362,11 @@ unrar_extract_file (struct unrar_argumen
 	  error (0, 0, "asprintf failed: %m\n");
 	  return 0;
 	}
+      if (!strncmp ("../", file, strlen("../")) || strstr (file, "/../"))
+	{
+          error (0, 0, "archive contains unsafe filename: '%s'\n", file);
+	  return -1;
+	}
       //where do i put it?  in destination.
       if (unrar->extract_newer)
 	{
