#!/bin/sh
#
# Test CVE-2017-14120

setUp() {
	uudecode >archive.rar <<EOF
begin-base64 644 -
UmFyIRoHAM+QcwAADQAAAAAAAABvvXQAgCUABQAAAAUAAAAAm7HC/4+CR0YU
MAUAIAAAAC4uL3h4YWFiDQo=
====
EOF
}

tearDown() {
	rm -f archive.tar ../xx
}

testList() {
	unrar-free --list archive.rar
	assertEquals "Status code" $? 0
}

testExtract() {
	unrar-free --extract archive.rar
	assertNotEquals "Status code" $? 0
	assertFalse "File does not exist" "-e ../xx"
}


. /usr/bin/shunit2
